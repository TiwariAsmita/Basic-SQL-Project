--1.CREATING TABLES
CREATE TABLE DEPOSIT
(ACTNO VARCHAR(5),
CNAME VARCHAR(20),
BNAME VARCHAR(20),
AMOUNT INT,
ADATE DATE);


CREATE TABLE BRANCH
(BNAME VARCHAR(20),
CITY VARCHAR(20)
);

CREATE TABLE CUSTOMER
(CNAME VARCHAR(20),
CITY VARCHAR(20)
);

CREATE TABLE BORROW
(LOANNO VARCHAR(5),
CNAME VARCHAR(20),
BNAME VARCHAR(20),
AMOUNT INT,
);


--2. DESCRIBING TABLES
sp_help DEPOSIT;
sp_help BRANCH;
sp_help CUSTOMER;
sp_help BORROW;

--4.INSERTING DATA
INSERT INTO DEPOSIT VALUES (100, 'ANIL','VRCE',1000,'1996-03-01'),
(101,'SUNIL','MGROAD',5000,'1996-01-04'),
(102, 'RAHUL', 'KAROLBAGH', 3500,'1995-11-17'),
(103,'MADHURI','CHANDANI',1200,'1995-12-17'),
(104,'PRAMOD','MGROAD',3000,'1997-03-27'),
(105, 'SANDEEP','KAROLBAGH',2000,'1996-03-31');

INSERT INTO BRANCH
VALUES
('VRCE','NAGPUR'),
('KAROLBAGH','DELHI'),
('CHANDANI', 'DELHI'),
('MGROAD','BANGLORE');

INSERT INTO BORROW (LOANNO, CNAME, BNAME, AMOUNT) VALUES
('201', 'ANIL', 'VRCE', 1000),
('206', 'RAHUL', 'KAROLBAGH', 5000),
('311', 'SUNIL', 'MGROAD', 3000),
('321', 'MADHURI', 'CHANDANI', 2000),
('375', 'PRAMOD', 'MGROAD', 8000);

--5.RETRIEVING DATA
--RETRIEVING DATA FROM DEPOSITS
SELECT * FROM DEPOSIT
DELETE FROM DEPOSIT WHERE CNAME = 'ANIL'
--RETRIEVING CUSTOMER NAME AND ACT NO
SELECT CNAME,ACTNO FROM DEPOSIT 

--RETRIEVING CUSTOMER NAME WHO LIVES IN NAGPUR: FOR THAT WE USE JOIN OPERATION BETWEEN CUSTOMER AND BRANCH TABLES WHERE CITY IS COMMON COLUMN
--WITH ALIASES
--INNER JOIN SYNTAX
--SELECT table1.column1, table1.column2, table2.column1, table2.column2
--FROM table1
--INNER JOIN table2 ON table1.common_column = table2.common_column;

SELECT C.CNAME FROM CUSTOMER C
JOIN BRANCH B ON C.CITY= B.CITY
WHERE B.CITY = 'NAGPUR'


--RETRIEVING NAME OF CUSTOMER WHO OPENED ACCOUNT AFTER 17 NOV 1995
--TABLES USED: CUSTOMER,DEPOSIT
--COMMON COLUMN CNAME

SELECT C.CNAME FROM CUSTOMER C
JOIN DEPOSIT D ON C.CNAME = D.CNAME
WHERE D.ADATE>'1995-11-17'


--RETRIEVE ACCOUNT NO AND AMOUNT OF CUSTOMER HAVING THEIR ACCOUNTS OPENED BETWEEN 1-12-95 TO 1-6-96

SELECT ACTNO, AMOUNT FROM DEPOSIT
WHERE ADATE BETWEEN '1995-12-01' AND '1996-06-01'

--RETRIEVING ALL NAMES FROM DEPOSIT WHERE CNMAE BEGINS WITH C

SELECT CNAME FROM DEPOSIT 
WHERE CNAME LIKE 'C%';

--RETRIEVING ALL DATA FROM BORROW WHERE SECOND CHARACTER OF CNAME IS U
SELECT * FROM BORROW
WHERE CNAME LIKE '_U%';

--RETRIEVING ALL DATA FROM BORROW WHERE BRANCH NAME IS CHANDANI OR MGROAD
SELECT * FROM BORROW
WHERE BNAME = 'CHANDANI' OR BNAME = 'MGROAD'

--RETRIEVING ALL DATA FROM BORROW WHERE BRANCH NAME IS NOT CHANDANI OR MGROAD
SELECT * FROM BORROW
WHERE BNAME <> 'CHANDANI' OR BNAME <> 'MGROAD'

--RETRIEVING ALL DATA FROM DEPOSIT WHERE AMOUNT NAME IS BETWEEN 2000 AND 3000

SELECT * FROM DEPOSIT
WHERE AMOUNT BETWEEN 2000 AND 3000
--CALCULATIG TA(10% OF AMOUNT), DA(20% OF AMOUNT)AND TOTAL OF EACH CUSTOMER FROM BORROW AND PROJECT CNAME AND AMOUNT

SELECT CNAME, AMOUNT
AMOUNT * 0.10 AS TA,                   --WHY IS THIS SHOWING ERROR??
AMOUNT * 0.20 AS DA,
AMOUNT * 0.10 + AMOUNT * 0.20 + AMOUNT AS Total,
FROM BORROW

SELECT 
    CNAME,
    AMOUNT,
    AMOUNT * 0.10 AS TA,
    AMOUNT * 0.20 AS DA,
    AMOUNT * 0.10 + AMOUNT * 0.20 + AMOUNT AS Total
FROM BORROW;

--RETRIEVING DATA FROM DEPOSIT WHERE AMOUNT>1000 AND ARRANGING IN ASCENDING ORDER

SELECT * FROM DEPOSIT
WHERE AMOUNT > 1000 
ORDER BY AMOUNT ASC;

SELECT * FROM DEPOSIT
WHERE AMOUNT >1000
ORDER BY AMOUNT DESC;

--RETRIEVING DATA FROM BORROW WHERE THIRD CHARACTER OF CUSTOMER NAME IS EITHER A OR D
SELECT * FROM BORROW 
WHERE CNAME LIKE '__A%' OR CNAME LIKE '__D%'
 
 --RETRIEVING TABLE FROM BORROW WHERE AMOUNT IS NOT BETWEEN 2000 AND 8000
 SELECT * FROM BORROW
 WHERE AMOUNT NOT BETWEEN 2000 AND 8000

 --FINDING UNIQUE RECORDS FROM TABLE DEPOSIT
SELECT DISTINCT * FROM DEPOSIT

--UPDATING AMOUNT OF DEPOSITERS IN DEPOSIT TABLE BY GIVING INTEREST OF 10% IN AMOUNT WHERE BRANCH IS VRCE
UPDATE DEPOSIT
SET AMOUNT=AMOUNT*0.1
WHERE BNAME = 'VRCE';

SELECT * FROM Deposit
WHERE BNAME = 'VRCE';

CREATE TABLE STUDENT
(NAME VARCHAR(20),
ROLLNO INT,
BRANCH VARCHAR(20),
CITY VARCHAR(20)
);
INSERT INTO STUDENT VALUES 
('VIJAYA', 150, 'CSE','CHENNAI'),
('SITA', 102, 'ETC', 'KOLKATA'),
('RAVI', 300, 'EEE', 'DELHI'),
('BASU', 165, 'ETC', 'CHENNAI'),
('RASMI', 107, 'ETC', 'RKL'),
('KARAN', 111,'CSE','CTC'),
('REKHA', 117, 'BME', 'BBSR');

SELECT * FROM STUDENT

--COUNTING NO OF STUDENTS OF EACH DEPARTMENT
SELECT BRANCH, COUNT(*) AS NumberOfStudents
FROM STUDENT
GROUP BY BRANCH;

--COUNTING NO OF STUDENTS OF EACH DEPARTMENT WHERE NAME STARTS WITH E
SELECT BRANCH, COUNT (*) AS NumberOfStudents
FROM STUDENT
WHERE BRANCH LIKE 'E%'
GROUP BY BRANCH;

--ADDING FIELD NAME MARKS
ALTER TABLE STUDENT ADD MARKS INT

SELECT * FROM STUDENT

--MODIFYING DATATYPE OF NAME TO HOLD 25 CHARACTERS
ALTER TABLE STUDENT
ALTER COLUMN STUDENTNAME VARCHAR(25);

--DELETING ALL ROWS FROM TABLE WHERE BRANCH IS ETC
DELETE FROM STUDENT
WHERE BRANCH = 'ETC'

--RENAMING TABLE NAME FROM STUDENT TO STUDINFO
EXEC sp_rename 'STUDENT', 'STUDINFORMATION';

SELECT* FROM STUDINFORMATION

--DELETING DATA PART FROM TABLE
TRUNCATE TABLE STUDINFORMATION

--DESTROY TABLE
DROP TABLE STUDINFORMATION

